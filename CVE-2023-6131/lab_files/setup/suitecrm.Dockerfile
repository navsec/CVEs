# Use the php:8.2.15-apache image
FROM php@sha256:39d43cc32ea91e96fa7333cd52f67b6d91c8c4b22130443db0b1ac5f26b7c738


# Optional: Copy over your custom configuration file
# COPY ./my-httpd.conf /usr/local/apache2/conf/httpd.conf



# Install Dependencies
COPY ./SuiteCRM-7.14.0.zip /tmp/
RUN apt update -y
RUN apt-get install -y  unzip libzip-dev
RUN a2enmod ssl && a2enmod rewrite

# Install SuiteCRM
RUN mkdir /var/www/html/suitecrm
RUN unzip /tmp/SuiteCRM-7.14.0.zip -d /tmp/
RUN mv /tmp/SuiteCRM-7.14.0/* /var/www/html/suitecrm/

RUN docker-php-ext-install \
  zip \
  mysqli \
  pdo_mysql \
  zip


WORKDIR /var/www/html/suitecrm
RUN chown -R www-data:www-data .
RUN chmod -R 755 .
RUN chmod -R 775 cache custom modules themes data upload
#RUN chmod 775 config_override.php 2>/dev/null

# Expose the port the app runs on
EXPOSE 80